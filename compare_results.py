#!/usr/bin/env python3
"""
Phase 4D 최적화 결과 비교 분석
"""

results = {
    "Phase 4D (기준선)": {
        "MAP": 0.8424,
        "MRR": 0.8500,
        "설정": "[5,4,2], TopK=50, 게이팅 OFF",
        "상태": "기준선",
        "차이": "-"
    },
    "Phase 6B-1 (게이팅)": {
        "MAP": 0.8083,
        "MRR": 0.8106,
        "설정": "[5,4,2], TopK=50, 게이팅 ON",
        "상태": "완료",
        "차이": "-3.41%"
    },
    "Phase 4D-NoGating": {
        "MAP": "평가 대기",
        "MRR": "평가 대기",
        "설정": "[5,4,2], TopK=50, 게이팅 OFF",
        "상태": "완료",
        "차이": "계산 중..."
    },
    "Phase 4D-TopK60": {
        "MAP": "평가 진행",
        "MRR": "평가 진행",
        "설정": "[5,4,2], TopK=60, 게이팅 ON",
        "상태": "진행 중 (25-30분)",
        "차이": "-"
    },
    "Phase 4D-Weight[5,5,2]": {
        "MAP": "예정",
        "MRR": "예정",
        "설정": "[5,5,2], TopK=50, 게이팅 ON",
        "상태": "대기",
        "차이": "-"
    }
}

print("="*100)
print("Phase 4D 최적화 전략 - 결과 비교")
print("="*100)
print()

# 테이블 형식 출력
print(f"{'Phase':<30} {'MAP':<12} {'MRR':<12} {'설정':<40} {'상태':<15} {'차이':<10}")
print("-" * 120)

for phase, data in results.items():
    print(f"{phase:<30} {str(data['MAP']):<12} {str(data['MRR']):<12} {data['설정']:<40} {data['상태']:<15} {data['차이']:<10}")

print()
print("="*100)
print("분석 노트")
print("="*100)
print("""
1. Phase 6B-1 (게이팅): MAP -3.41% 하락
   - 문제: 비과학 질문 16% (35개)에 대해 topk=[] 정책 적용
   - 가설: 게이팅이 과도하거나 부정확

2. Phase 4D-NoGating 테스트:
   - 목표: 기준선 (0.8424) 복구 확인
   - 예상: 0.8424 근처 (게이팅 정책 제거로 모든 질문 검색)
   
3. Phase 4D-TopK60 진행 중:
   - 목표: 더 넓은 후보군으로 재순위화
   - 가설: 더 좋은 문서가 상위 60개에 포함될 가능성
   - 예상: +0.5-1% 개선 가능

4. 다음 단계:
   - Phase 4D-TopK60 완료 후 결과 분석
   - 최고 성능 설정으로 최종 평가
""")
