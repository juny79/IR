# submission_82_surgical_v1.csv ìƒì„± ê³¼ì • ë° íŒŒì¼ ê´€ê³„ë„

## ğŸ“Œ íŒŒì¼ ë™ì¼ì„± í™•ì¸
- `submission_82_surgical_v1.csv` = `submission_surgical_v1.csv` (ë™ì¼ íŒŒì¼)
- SHA256: `c3e0d7c3609c343faa239a0c3d02096e7356b92f0006b95ff5fddc171931fb53`
- í¬ê¸°: 177KB
- **ë¦¬ë”ë³´ë“œ ì ìˆ˜: MAP 0.9470, MRR 0.9470** (ìµœê³  ê¸°ë¡)

---

## ğŸ”„ ì „ì²´ íŒŒì¼ ê´€ê³„ë„ (Flowchart)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Phase 0: ì›ë³¸ ë°ì´í„°                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ data/documents.jsonl  â”‚  â† 4,272ê°œ ì›ë³¸ ë¬¸ì„œ
         â”‚ data/eval.jsonl       â”‚  â† 600ê°œ í‰ê°€ ì§ˆë¬¸
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         â”‚
    â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Phase 1: í•©ì„± ë°ì´í„° ìƒì„± (Synthetic QA)                     â”‚
â”‚                                                                      â”‚
â”‚  finetune/1_generate_qa.py                                          â”‚
â”‚  â”œâ”€ ì‚¬ìš©: models/solar_client.py                                    â”‚
â”‚  â”œâ”€ ì…ë ¥: data/documents.jsonl                                      â”‚
â”‚  â””â”€ ì¶œë ¥: data/synthetic_qa_solar.jsonl (12,816 QA pairs)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Phase 2: Hard Negative Mining (ì–´ë ¤ìš´ ì˜¤ë‹µ ì¶”ì¶œ)                 â”‚
â”‚                                                                      â”‚
â”‚  finetune/2_mine_negatives_v3.py                                    â”‚
â”‚  â”œâ”€ ì‚¬ìš©: retrieval/es_connector.py (Elasticsearch)                 â”‚
â”‚  â”œâ”€     : FlagEmbedding.BGEM3FlagModel (Dense Search)               â”‚
â”‚  â”œâ”€     : BAAI/bge-reranker-v2-m3 (Cross-Encoder)                  â”‚
â”‚  â”œâ”€ ì…ë ¥: data/synthetic_qa_solar.jsonl                             â”‚
â”‚  â””â”€ ì¶œë ¥: data/train_data_v3.jsonl (12,816 samples)                â”‚
â”‚           ê° ìƒ˜í”Œ: 1ê°œ query + 1ê°œ positive + 7ê°œ hard negatives    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Phase 3: BGE-M3 íŒŒì¸íŠœë‹ (Model Training)                    â”‚
â”‚                                                                      â”‚
â”‚  finetune/3_run_train_v3.sh                                         â”‚
â”‚  â”œâ”€ í”„ë ˆì„ì›Œí¬: FlagEmbedding (HuggingFace)                         â”‚
â”‚  â”œâ”€ ë² ì´ìŠ¤ ëª¨ë¸: BAAI/bge-m3                                         â”‚
â”‚  â”œâ”€ í•™ìŠµ ë°ì´í„°: data/train_data_v3.jsonl                           â”‚
â”‚  â”œâ”€ í•˜ì´í¼íŒŒë¼ë¯¸í„°:                                                  â”‚
â”‚  â”‚   - Epochs: 5                                                    â”‚
â”‚  â”‚   - Batch Size: 32 (effective)                                   â”‚
â”‚  â”‚   - Learning Rate: 1e-5                                          â”‚
â”‚  â”‚   - Temperature: 0.02                                            â”‚
â”‚  â””â”€ ì¶œë ¥: finetuned_bge_m3_v3/ (2.27GB)                             â”‚
â”‚           â”œâ”€ model.safetensors                                      â”‚
â”‚           â”œâ”€ config.json                                            â”‚
â”‚           â””â”€ ...                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Phase 4a: V3 íŒŒì¸íŠœë‹ ëª¨ë¸ ë‹¨ë… í‰ê°€ (ì²« ì‹œë„)                     â”‚
â”‚                                                                      â”‚
â”‚  eval_rag_bge_m3_v3.py                                              â”‚
â”‚  â”œâ”€ ì‚¬ìš© ëª¨ë¸: finetuned_bge_m3_v3/                                 â”‚
â”‚  â”œâ”€ ì „ëµ: Hybrid Search (Dense 0.5 + Sparse 0.5)                   â”‚
â”‚  â”œâ”€      + BGE-reranker-v2-m3                                       â”‚
â”‚  â””â”€ ì¶œë ¥: submission_v3_final_rerank.csv                            â”‚
â”‚           ë¦¬ë”ë³´ë“œ ì ìˆ˜: MAP 0.3318 âŒ (ê¸‰ë½)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Phase 4b: 4-ëª¨ë¸ ì•™ìƒë¸” (ê¸´ê¸‰ ì¡°ì¹˜)                               â”‚
â”‚                                                                      â”‚
â”‚  eval_rag_v3_ensemble.py (ì¶”ì •)                                     â”‚
â”‚  â”œâ”€ ì•™ìƒë¸”: BM25 + SBERT + Gemini + BGE-M3-V3                       â”‚
â”‚  â”œâ”€ ì „ëµ: Hard Voting (4ê°œ ëª¨ë¸ íˆ¬í‘œ)                               â”‚
â”‚  â””â”€ ì¶œë ¥: submission_v3_ensemble.csv                                â”‚
â”‚           â†’ submission_v3_final.csv (ì¤‘ë³µ ì œê±° í›„)                   â”‚
â”‚           ë¦¬ë”ë³´ë“œ ì ìˆ˜: MAP 0.8917 (ì—¬ì „íˆ ë‚®ìŒ)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Phase 5: Surgical Strike ì „ëµ (ìµœì¢… ëŒíŒŒ)                   â”‚
â”‚                                                                      â”‚
â”‚  surgical_strike.py                                                 â”‚
â”‚  â”œâ”€ ì…ë ¥ íŒŒì¼:                                                       â”‚
â”‚  â”‚   â”œâ”€ submission_v9_sota.csv        (MAP 0.9409, ê²€ì¦ëœ ë² ì´ìŠ¤)  â”‚
â”‚  â”‚   â””â”€ submission_v3_final.csv       (4-ëª¨ë¸ ì•™ìƒë¸” ê²°ê³¼)          â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€ ì‚¬ìš© ëª¨ë“ˆ:                                                       â”‚
â”‚  â”‚   â”œâ”€ models/gemini_client.py       (Gemini-Flashë¥¼ LLM Judge)   â”‚
â”‚  â”‚   â””â”€ retrieval/es_connector.py     (ë¬¸ì„œ ë‚´ìš© ì¡°íšŒ)              â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€ ì²˜ë¦¬ ë¡œì§:                                                       â”‚
â”‚  â”‚   1. v9_sotaì™€ v3_finalì˜ Top-1 ë¹„êµ                            â”‚
â”‚  â”‚   2. ì¶©ëŒ ë°œìƒ 21ê°œ ID ì¶”ì¶œ                                       â”‚
â”‚  â”‚   3. ê° IDì˜ Top-5 í›„ë³´êµ° í•©ì¹˜ê¸° (ì¤‘ë³µ ì œê±°)                     â”‚
â”‚  â”‚   4. Gemini-Flashì—ê²Œ "ì–´ë–¤ ë¬¸ì„œê°€ ë” ì •ë‹µì¸ê°€?" íŒì • ìš”ì²­       â”‚
â”‚  â”‚   5. Geminiê°€ í™•ì‹ í•˜ëŠ” ê²½ìš°ì—ë§Œ ë³€ê²½ (ì„ ë³„ì  ìˆ˜ì •)               â”‚
â”‚  â”‚   6. ë‚˜ë¨¸ì§€ëŠ” v9_sota ìœ ì§€ (ì•ˆì •ì„± í™•ë³´)                         â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â””â”€ ì¶œë ¥: submission_surgical_v1.csv                                â”‚
â”‚           = submission_82_surgical_v1.csv (ë™ì¼ íŒŒì¼)               â”‚
â”‚           ë¦¬ë”ë³´ë“œ ì ìˆ˜: MAP 0.9470, MRR 0.9470 âœ… (ìµœê³  ê¸°ë¡!)     â”‚
â”‚           ë³€ê²½ ID ìˆ˜: 11ê°œ (ì„ ë³„ì  ë³€ê²½, 5% ê°œì„ )                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ í•µì‹¬ íŒŒì¼ë³„ ì—­í• 

### 1. **ë°ì´í„° íŒŒì¼**
| íŒŒì¼ëª… | ìš©ë„ | í¬ê¸° | ìƒì„± ë‹¨ê³„ |
|--------|------|------|-----------|
| `data/documents.jsonl` | ì›ë³¸ 4,272ê°œ ë¬¸ì„œ | ~10MB | ì´ˆê¸° ë°ì´í„° |
| `data/eval.jsonl` | 600ê°œ í‰ê°€ ì§ˆë¬¸ | ~500KB | ì´ˆê¸° ë°ì´í„° |
| `data/synthetic_qa_solar.jsonl` | Solar Pro 2ê°€ ìƒì„±í•œ 12,816ê°œ QA | ~5MB | Phase 1 |
| `data/train_data_v3.jsonl` | í•™ìŠµìš© 12,816 ìƒ˜í”Œ (pos+neg) | ~27MB | Phase 2 |

### 2. **íŒŒì¸íŠœë‹ ìŠ¤í¬ë¦½íŠ¸**
| íŒŒì¼ëª… | ì—­í•  | í•µì‹¬ ê¸°ìˆ  |
|--------|------|-----------|
| `finetune/1_generate_qa.py` | QA ìë™ ìƒì„± | Solar Pro 2 API |
| `finetune/2_mine_negatives_v3.py` | Hard Negative ì¶”ì¶œ | BM25 + Dense + Reranker |
| `finetune/3_run_train_v3.sh` | BGE-M3 í•™ìŠµ ì‹¤í–‰ | FlagEmbedding |

### 3. **ëª¨ë¸ ë””ë ‰í† ë¦¬**
| ê²½ë¡œ | ë‚´ìš© | í¬ê¸° |
|------|------|------|
| `finetuned_bge_m3_v3/` | íŒŒì¸íŠœë‹ëœ BGE-M3 ëª¨ë¸ | 2.27GB |
| `finetuned_bge_m3_v2/` | V2 ëª¨ë¸ (ì¤‘ê°„ ë²„ì „) | 2.27GB |
| `finetuned_bge_m3/` | V1 ëª¨ë¸ (ì´ˆê¸° ë²„ì „) | 2.27GB |

### 4. **í‰ê°€ ìŠ¤í¬ë¦½íŠ¸**
| íŒŒì¼ëª… | ìš©ë„ | ì¶œë ¥ |
|--------|------|------|
| `eval_rag_bge_m3_v3.py` | V3 ë‹¨ë… í‰ê°€ | submission_v3_final_rerank.csv |
| `eval_rag_v3_ensemble.py` | 4-ëª¨ë¸ ì•™ìƒë¸” | submission_v3_ensemble.csv |
| `surgical_strike.py` | â­ ìµœì¢… Surgical Strike | **submission_surgical_v1.csv** |

### 5. **ëª¨ë¸ í´ë¼ì´ì–¸íŠ¸ ëª¨ë“ˆ**
| íŒŒì¼ëª… | ì—­í•  | ì‚¬ìš© ìœ„ì¹˜ |
|--------|------|-----------|
| `models/solar_client.py` | Solar Pro 2 API ë˜í¼ | QA ìƒì„±, í‰ê°€ |
| `models/gemini_client.py` | Gemini API ë˜í¼ | LLM Judge (Surgical Strike) |

### 6. **ê²€ìƒ‰ ëª¨ë“ˆ**
| íŒŒì¼ëª… | ì—­í•  | ì‚¬ìš© ìœ„ì¹˜ |
|--------|------|-----------|
| `retrieval/es_connector.py` | Elasticsearch ì¸í„°í˜ì´ìŠ¤ | Hard Negative Mining, ë¬¸ì„œ ì¡°íšŒ |

---

## ğŸ¯ Surgical Strike í•µì‹¬ ì•Œê³ ë¦¬ì¦˜

```python
# surgical_strike.py í•µì‹¬ ë¡œì§

1. ë² ì´ìŠ¤ë¼ì¸ ë¡œë“œ
   - v9_sota.csv (MAP 0.9409) â† ê²€ì¦ëœ ê³ ë“ì  íŒŒì¼
   - v3_final.csv (MAP 0.8917) â† 4-ëª¨ë¸ ì•™ìƒë¸” ê²°ê³¼

2. ì¶©ëŒ ID ì¶”ì¶œ
   - Top-1ì´ ë‹¤ë¥¸ 21ê°œ ID ì‹ë³„
   
3. ê° ì¶©ëŒ IDì— ëŒ€í•´:
   a. v9ì˜ Top-5ì™€ v3ì˜ Top-5ë¥¼ í•©ì¹¨ (ì¤‘ë³µ ì œê±°)
   b. ê° í›„ë³´ ë¬¸ì„œì˜ ì „ì²´ ë‚´ìš©ì„ Elasticsearchì—ì„œ ê°€ì ¸ì˜´
   c. Gemini-Flashì—ê²Œ ë‹¤ìŒ ì§ˆë¬¸:
      "ì§ˆë¬¸: {query}
       í›„ë³´ ë¬¸ì„œë“¤: {1. doc1, 2. doc2, ...}
       ê°€ì¥ ì •ë‹µì— ê°€ê¹Œìš´ ë¬¸ì„œì˜ ë²ˆí˜¸ëŠ”?"
   d. Geminiê°€ ì„ íƒí•œ ë¬¸ì„œë¥¼ Top-1ë¡œ ì„¤ì •
   e. ë‚˜ë¨¸ì§€ ë¬¸ì„œë“¤ì€ ìˆœì„œëŒ€ë¡œ ë°°ì¹˜

4. ê²°ê³¼ ì €ì¥
   - 21ê°œ ì¤‘ 11ê°œë¥¼ ë³€ê²½ (Geminiê°€ í™•ì‹ í•œ ê²½ìš°ë§Œ)
   - ë‚˜ë¨¸ì§€ 199ê°œëŠ” v9_sota ê·¸ëŒ€ë¡œ ìœ ì§€
   - ìµœì¢… íŒŒì¼: submission_surgical_v1.csv
```

### Surgical Strike ì„±ê³µ ìš”ì¸

1. **ì„ ë³„ì  ë³€ê²½**: ì „ì²´ì˜ 5%ë§Œ ìˆ˜ì • (11/220)
2. **LLM Judge í™œìš©**: ë‹¨ìˆœ ì ìˆ˜ ë¹„êµê°€ ì•„ë‹Œ ë¬¸ë§¥ ê¸°ë°˜ íŒë‹¨
3. **ì•ˆì •ì  ë² ì´ìŠ¤**: 0.9409 ê²€ì¦ëœ íŒŒì¼ì—ì„œ ì‹œì‘
4. **Geminiì˜ íŒë‹¨ë ¥**: í™•ë¥  ê³„ì‚°, ì¼ì‹ ì›ë¦¬ ë“± ì˜¤ë¥˜ ìˆ˜ì •

---

## ğŸ“Š ì„±ëŠ¥ ë³€í™” ì¶”ì´

| ë‹¨ê³„ | íŒŒì¼ëª… | ì „ëµ | MAP | ë³€í™” |
|------|--------|------|-----|------|
| ë² ì´ìŠ¤ | submission_v9_sota.csv | ê¸°ì¡´ SOTA | 0.9409 | - |
| V3 ë‹¨ë… | submission_v3_final_rerank.csv | íŒŒì¸íŠœë‹ ë‹¨ë… | 0.3318 | âŒ -0.609 |
| V3 ì•™ìƒë¸” | submission_v3_final.csv | 4-ëª¨ë¸ íˆ¬í‘œ | 0.8917 | âŒ -0.049 |
| **ìµœì¢…** | **submission_surgical_v1.csv** | **Surgical Strike** | **0.9470** | âœ… **+0.0061** |

---

## ğŸ”— ì˜ì¡´ì„± ê·¸ë˜í”„

```
submission_82_surgical_v1.csv
    â”‚
    â”œâ”€ surgical_strike.py (ìƒì„± ìŠ¤í¬ë¦½íŠ¸)
    â”‚   â”œâ”€ models/gemini_client.py (LLM Judge)
    â”‚   â”œâ”€ retrieval/es_connector.py (ë¬¸ì„œ ì¡°íšŒ)
    â”‚   â”œâ”€ submission_v9_sota.csv (ë² ì´ìŠ¤ë¼ì¸)
    â”‚   â””â”€ submission_v3_final.csv (ë¹„êµ ëŒ€ìƒ)
    â”‚       â””â”€ eval_rag_v3_ensemble.py (ì•™ìƒë¸” í‰ê°€)
    â”‚           â””â”€ finetuned_bge_m3_v3/ (íŒŒì¸íŠœë‹ ëª¨ë¸)
    â”‚               â””â”€ finetune/3_run_train_v3.sh (í•™ìŠµ)
    â”‚                   â””â”€ data/train_data_v3.jsonl (í•™ìŠµ ë°ì´í„°)
    â”‚                       â””â”€ finetune/2_mine_negatives_v3.py (Hard Negative Mining)
    â”‚                           â”œâ”€ data/synthetic_qa_solar.jsonl (í•©ì„± QA)
    â”‚                           â”‚   â””â”€ finetune/1_generate_qa.py (QA ìƒì„±)
    â”‚                           â”‚       â”œâ”€ models/solar_client.py (Solar API)
    â”‚                           â”‚       â””â”€ data/documents.jsonl (ì›ë³¸ ë¬¸ì„œ)
    â”‚                           â”œâ”€ retrieval/es_connector.py (Elasticsearch)
    â”‚                           â””â”€ BAAI/bge-reranker-v2-m3 (Reranker ëª¨ë¸)
    â”‚
    â””â”€ data/eval.jsonl (í‰ê°€ ì§ˆë¬¸)
```

---

## ğŸš€ ì¬í˜„ ê°€ëŠ¥ì„±

### ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ìˆœì„œ

```bash
# 1. QA ìƒì„± (1-2ì‹œê°„)
cd /root/IR
python finetune/1_generate_qa.py
# ì¶œë ¥: data/synthetic_qa_solar.jsonl (12,816 QA pairs)

# 2. Hard Negative Mining (2-3ì‹œê°„)
python finetune/2_mine_negatives_v3.py
# ì¶œë ¥: data/train_data_v3.jsonl (12,816 samples)

# 3. ëª¨ë¸ í•™ìŠµ (~30-40ë¶„, GPU í•„ìš”)
bash finetune/3_run_train_v3.sh
# ì¶œë ¥: finetuned_bge_m3_v3/ (2.27GB)

# 4. V3 ë‹¨ë… í‰ê°€ (~10-15ë¶„)
python eval_rag_bge_m3_v3.py
# ì¶œë ¥: submission_v3_final_rerank.csv

# 5. 4-ëª¨ë¸ ì•™ìƒë¸” í‰ê°€ (~1-2ì‹œê°„)
python eval_rag_v3_ensemble.py
# ì¶œë ¥: submission_v3_final.csv

# 6. Surgical Strike (ìµœì¢…) (~5-10ë¶„)
python surgical_strike.py
# ì¶œë ¥: submission_surgical_v1.csv (= submission_82_surgical_v1.csv)
```

### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

```bash
# .env íŒŒì¼
UPSTAGE_API_KEY=your_solar_api_key
GOOGLE_API_KEY=your_gemini_api_key
```

### í•„ìˆ˜ íŒ¨í‚¤ì§€

```bash
pip install FlagEmbedding sentence-transformers elasticsearch torch tqdm
```

---

## ğŸ“ í•µì‹¬ êµí›ˆ

1. âœ… **íŒŒì¸íŠœë‹ ë‹¨ë… ì‚¬ìš©ì€ ìœ„í—˜**: í•©ì„± ë°ì´í„° ê³¼ì í•©
2. âœ… **LLM Judge í™œìš©**: ì„ ë³„ì  ê°œì„ ì— ë§¤ìš° íš¨ê³¼ì 
3. âœ… **Surgical Strike**: ì „ì²´ ë³€ê²½ë³´ë‹¤ 5-10% ì„ ë³„ ë³€ê²½ì´ ì•ˆì „
4. âœ… **ë² ì´ìŠ¤ë¼ì¸ ì¤‘ìš”ì„±**: ê²€ì¦ëœ ê³ ë“ì  íŒŒì¼ì—ì„œ ì‹œì‘
5. âœ… **ì•™ìƒë¸”ì˜ í•œê³„**: 4ê°œ ëª¨ë¸ íˆ¬í‘œë„ 0.9409ì„ ë„˜ì§€ ëª»í•¨

---

**ì‘ì„±ì¼**: 2025ë…„ 12ì›” 29ì¼  
**ìµœì¢… ì„±ê³¼**: MAP 0.9470, MRR 0.9470 (ë¦¬ë”ë³´ë“œ ìµœê³  ê¸°ë¡)  
**í•µì‹¬ ì „ëµ**: Surgical Strike (LLM Judge ê¸°ë°˜ ì„ ë³„ì  ê°œì„ )
