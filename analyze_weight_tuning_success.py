#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import json
import numpy as np

print("=" * 90)
print("Hard Voting [6,3,1] íŒŒë¼ë¯¸í„° íŠœë‹ ì„±ê³µ ë¶„ì„")
print("=" * 90)

print("\n1ï¸âƒ£ ì„±ëŠ¥ ê°œì„ ë„ (ë†€ë¼ìš´ ê²°ê³¼)")
print("-" * 90)
print(f"  Phase 2 (Weight [5,3,1]):")
print(f"    MAP: 0.7970")
print(f"    MRR: 0.8015")
print(f"\n  Weight [6,3,1]:")
print(f"    MAP: 0.8470 â­â­â­")
print(f"    MRR: 0.8500 â­â­â­")
print(f"\n  ê°œì„ ë„:")
print(f"    MAP: +0.0500 (+6.3%) ğŸš€")
print(f"    MRR: +0.0485 (+6.0%) ğŸš€")

print("\n2ï¸âƒ£ ê°€ì¤‘ì¹˜ ë³€í™” ë¶„ì„")
print("-" * 90)
print(f"  ê¸°ë³¸ê°’ [5,3,1]:")
print(f"    Rank 1: 5ì  (40%)")
print(f"    Rank 2: 3ì  (24%)")
print(f"    Rank 3: 1ì  (8%)")
print(f"    í•©ê³„: 12ì ")
print(f"\n  ìƒˆ ê°€ì¤‘ì¹˜ [6,3,1]:")
print(f"    Rank 1: 6ì  (43%)")
print(f"    Rank 2: 3ì  (21%)")
print(f"    Rank 3: 1ì  (7%)")
print(f"    í•©ê³„: 11ì ")
print(f"\n  ë³€í™”:")
print(f"    Rank 1 ìš°ëŒ€: +1ì  (+20% relative)")
print(f"    Rank 2,3: ë³€í™” ì—†ìŒ")

print("\n3ï¸âƒ£ ì™œ ì´ë ‡ê²Œ í° ê°œì„ ì´?")
print("-" * 90)
print("""
ğŸ“Š ê°€ì„¤ 1: Sparse/Dense ê· í˜• ê°œì„ 
   - HyDEê°€ Sparseì™€ Dense ê²°ê³¼ë¥¼ ë‹¤ë¥´ê²Œ ë§Œë“¦
   - [5,3,1]: Sparse ìš°ëŒ€ë„ ë¶€ì¡±í–ˆê³ , Dense ìš°ëŒ€ë„ ë¶ˆì¶©ë¶„
   - [6,3,1]: Rank 1 ìš°ëŒ€ë¡œ ìƒìœ„ ë¬¸ì„œ ì‹ ë¢°ë„ ì¦ê°€
   - ê²°ê³¼: Hard Votingì´ ë” ì •í™•í•œ Top-20 ì„ ì •

ğŸ“Š ê°€ì„¤ 2: Reranker ì…ë ¥ í’ˆì§ˆ í–¥ìƒ
   - Hard Voting [6,3,1]ë¡œ ë” ì–‘ì§ˆì˜ Top-20 í›„ë³´êµ° ìƒì„±
   - Rerankerê°€ ë” ë‚˜ì€ candidatesì—ì„œ ì„ íƒ
   - ìµœì¢… Top-5 ì •í™•ë„ ëŒ€í­ ìƒìŠ¹

ğŸ“Š ê°€ì„¤ 3: íŠ¹ì • ì§ˆë¬¸ ìœ í˜• ì„±ëŠ¥ í–¥ìƒ
   - Sparseê°€ ì¢‹ì€ ê²°ê³¼ë¥¼ ì£¼ëŠ” ì§ˆë¬¸:
     + ëª…ì‚¬/í‚¤ì›Œë“œ ê¸°ë°˜ (ì‹ë¬¼, í™”í•™, ì—­ì‚¬ ë“±)
     + ì¼ë°˜ì ì¸ ì§€ì‹ ì§ˆë¬¸
   - Rank 1 ìš°ëŒ€ [6,3,1]ì´ ì´ëŸ° ì§ˆë¬¸ì—ì„œ í° íš¨ê³¼
   - Rank 1 ì¼ì¹˜ìœ¨ ë†’ì€ ì§ˆë¬¸ì´ ë§ì•˜ì„ ìˆ˜ ìˆìŒ

ğŸ“Š ê°€ì„¤ 4: ê¸°ë³¸ ê°€ì¤‘ì¹˜ê°€ ì°¨ì„ (suboptimal)ì´ì—ˆìŒ
   - [5,3,1]ì€ ì¼ë°˜ì ì¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°
   - ìš°ë¦¬ ë°ì´í„°ì…‹+ëª¨ë¸ ì¡°í•©ì—ëŠ” [6,3,1]ì´ ìµœì 
   - ì‘ì€ ë³€ê²½ìœ¼ë¡œë„ 6% ê°œì„  ê°€ëŠ¥ = ê¸°ë³¸ê°’ì´ ì°¨ì„ 
""")

print("\n4ï¸âƒ£ ì˜ë¯¸ ë¶„ì„: ë¬´ì—‡ì´ ë‹¬ë¼ì¡Œë‚˜?")
print("-" * 90)

# ê°œë…ì  ë¶„ì„
print("""
Hard Voting ë©”ì»¤ë‹ˆì¦˜:
  - Sparse (BM25): ì •í™•í•œ í‚¤ì›Œë“œ ë§¤ì¹­
  - Dense (SBERT): ì˜ë¯¸ì  ìœ ì‚¬ì„±
  
ê¸°ë³¸ [5,3,1]:
  Rank 1 Sparse + Rank 1 Dense = 10ì 
  Rank 1 Sparse + Rank 5 Dense = 5ì 
  â†’ Denseì˜ ë‚®ì€ ìˆœìœ„ë„ ì˜í–¥ ìˆìŒ

ê°œì„  [6,3,1]:
  Rank 1 Sparse + Rank 1 Dense = 12ì  (+20%)
  Rank 1 Sparse + Rank 5 Dense = 6ì  (+20%)
  â†’ Rank 1ì˜ ì‹ ë¢°ë„ë¥¼ ë” ë†’ì„

íš¨ê³¼:
  âœ… Sparse/Dense ëª¨ë‘ Rank 1ì¼ ë•Œ: ë” ê°•í•˜ê²Œ ìš°ëŒ€
  âœ… í•œìª½ë§Œ Rank 1ì¼ ë•Œ: ìƒëŒ€ ê°€ì¤‘ì¹˜ ëŒ€ë¹„ ë” ê°•í•¨
  âœ… ê²°ê³¼: Top-20 í›„ë³´ê°€ ë” ì •í™•í•´ì§
""")

print("\n5ï¸âƒ£ í•µì‹¬ ì¸ì‚¬ì´íŠ¸")
print("-" * 90)
print("""
ğŸ¯ Why [6,3,1] works better:
   1. HyDEì˜ ë¶ˆì¼ì¹˜ ë¬¸ì œ í•´ê²°
      - Sparse/Denseê°€ ë‹¤ë¥¸ ê²°ê³¼ ì œê³µ
      - Rank 1 ìš°ëŒ€ë¡œ ìƒìœ„ ì‹ í˜¸ ê°•í™”
      - ë‹¤ì¤‘ ì‹ í˜¸ ê°„ ì‹ ë¢°ë„ ì¡°ì •
   
   2. Hard Votingì˜ ì—­í•  ì¬ì •ì˜
      - [5,3,1]: ê· í˜•ì¡íŒ ê°€ì¤‘ì¹˜
      - [6,3,1]: Rank 1 ì‹ í˜¸ ê°•ì¡°
      - ìƒìœ„ ë¬¸ì„œì˜ ì¤‘ìš”ë„ ì¦ê°€
   
   3. Rerankerì˜ ì„±ëŠ¥ í–¥ìƒ
      - ë” ë‚˜ì€ Top-20 â†’ ë” ë‚˜ì€ Reranking
      - Cross-Encoderê°€ ì¢‹ì€ í›„ë³´ì—ì„œë§Œ ì„ íƒ
      - ìµœì¢… Top-5 ì •í™•ë„ â†‘â†‘â†‘

ğŸ“ êµí›ˆ:
   - ê°„ë‹¨í•œ íŒŒë¼ë¯¸í„° ì¡°ì •ì´ í° íš¨ê³¼
   - ë°ì´í„°ì…‹/ëª¨ë¸ì— ë§ëŠ” ìµœì ê°’ ì¡´ì¬
   - Multi-signal fusionì—ì„œ ê°€ì¤‘ì¹˜ ì¤‘ìš”
""")

print("\n6ï¸âƒ£ ë‹¤ìŒ ë‹¨ê³„")
print("-" * 90)
print("""
âœ… ì„±ê³µ: [6,3,1] â†’ MAP 0.8470
â­ï¸  ë‹¤ìŒ ì‹œë„:
   1. [7,4,2]: Rank ì°¨ë“±í™” ë” ê°•í™”
      - ì˜ˆìƒ: MAP 0.84~0.86 (ì†Œí­ ê°œì„  ê°€ëŠ¥)
   
   2. [6,4,1]: Rank 2 ìš°ëŒ€
      - ì˜ˆìƒ: MAP 0.83~0.84 (í•˜ë½ ê°€ëŠ¥)
   
   3. [5,4,1]: Rank 2,3 ìš°ëŒ€
      - ì˜ˆìƒ: MAP 0.80~0.82 (í•˜ë½ ê°€ëŠ¥)
   
ğŸ† ìµœì¢… ê¶Œì¥:
   - [6,3,1] ìœ ì§€ í›„ [7,4,2] í…ŒìŠ¤íŠ¸
   - [7,4,2]ê°€ 0.85+ ë‹¬ì„± ê°€ëŠ¥ì„± ìˆìŒ
""")

print("\n" + "=" * 90)
print("ê²°ë¡ : Hard Voting ê°€ì¤‘ì¹˜ íŠœë‹ì€ í° ê°€ì¹˜!")
print("=" * 90)
